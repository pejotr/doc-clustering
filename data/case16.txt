{$A+,B-,D+,E+,F-,G-,I-,L+,N-,O-,R+,S+,V-,X+}
{$M 16384,0,655360}

unit MASEmpl;

interface

uses

  DOS,          Crt,
  Objects,  Drivers,    Views,    Menus,      App,
  Memory,   Dialogs,    SADDlg,   SADMouse,
  MASInit,  MASRapor, SADMsg, Printer, MASFirm, ConProc, MASKontr;


type
  StazArray = Array [1..10] of String[80];

  PEmplCollection = ^TEmplCollection;
  TEmplCollection = object ( TSortedCollection )
      function Compare( Key1, Key2 : Pointer) : Integer; virtual;
  end;

  PEmplItem = ^TEmplItem;
  TEmplItem = object( TObject )
     Name, FirstName, FirstName1, FathersName, MothersName, BirthPlace,
     BirthDate, PesselNumber,
     Gmina, Miejsce, NumerDomu, NumerMieszk, Ulica, Kod, Woj, Stan, ZatrDate: PString;
     Staz : array[1..10] of PString;
     Wynagr : array[1..6,1..12] of PString;


    constructor Init(NewName, NewFirstName, NewFirstName1, NewFathersName, NewMothersName, NewBirthPlace,
     NewBirthDate, NewPesselNumber,
     NewGmina, NewMiejsce, NewNumerDomu, NewNumerMieszk, NewUlica, NewKod, NewWoj, NewStan, NewZatrDate:String;
     NewStaz : StazArray);
    procedure Change(NewName, NewFirstName, NewFirstName1, NewFathersName, NewMothersName, NewBirthPlace,
     NewBirthDate, NewPesselNumber,
     NewGmina, NewMiejsce, NewNumerDomu, NewNumerMieszk, NewUlica, NewKod, NewWoj:String);
    procedure Store( var S : TStream); virtual;
    constructor Load( var S : TStream);
    destructor Done; virtual;

  end;

  { List Box for Empl Window }

   PEmplListBox = ^TEmplListBox;
   TEmplListBox = object ( TListBox )
    function GetText( Item : Integer; MaxLen : Integer ): String; virtual;
 end;

 PSecondDialog = ^TSecondDialog;
 TSecondDialog = object (TDialog )
    FirstItemPointer : PInputLine;
 end;



 { Empl Window }

   PEmplWindow = ^TEmplWindow;
   TEmplWindow = object ( TDialog )
    ListBoxPointer : PListBox;
    SecondDialog   : PSecondDialog;
    ThirdDialog    : PSecondDialog;
    ThirdDialogData : record
       InpLine1 : String[10];
       InpLine2 : String[10];
       InpLine3 : String[10];
       InpLine4 : String[10];
       InpLine5 : String[10];
       InpLine6 : String[10];
       InpLine7 : String[10];
    end;
    SecondDialogData : record
      InputLine1 : String[40];
      InputLine2: String[40];
      InputLine3 : String[40];
      InputLine4 : String[40];
      InputLine5 : String[40];
      InputLine6 : String[40];
      InputLine7 : String[40];
      InputLine8 : String[40];
      InputLine9: String[40];
      InputLine10: String[40];
      InputLine11: String[40];
      InputLine12: String[40];
      InputLine13: String[40];
      InputLine14: String[40];
      InputLine15: String[40];
      InputLine16: String[40];
      InputLine17: String[40];
      InputStaz1: String[80];
      InputStaz2: String[80];
      InputStaz3: String[80];
      InputStaz4: String[80];
      InputStaz5: String[80];
      InputStaz6: String[80];
      InputStaz7: String[80];
      InputStaz8: String[80];
      InputStaz9: String[80];
      InputStaz10: String[80];


    end;
    procedure HandleEvent( var Event : TEvent ); virtual;
    procedure Close; virtual;
 end;


   PrinterLine = array [1..132] of char;

const

 { Maximum printer line length }

   MaxLenPRN = 130;

 { Stream registration records }

  REmplCollection : TStreamRec = (
   ObjType : 1006;
   VmtLink : Ofs(TypeOf(TEmplCollection)^);
   Load: @TEmplCollection.Load;
   Store: @TEmplCollection.Store);

  REmplItem : TStreamRec = (
   ObjType: 1007;
   VmtLink: Ofs(TypeOf(TEmplItem)^);
   Load: @TEmplItem.Load;
   Store: @TEmplItem.Store);


   Days : array [0..6] of String[20] =
    ('Niedziela','Poniedziaíek','Wtorek',
     'òroda','Czwartek','PiÜtek',
     'Sobota');

     Months : array [1..12] of String[20] =
    ('Stycze§    ','Luty       ','Marzec     ',
     'Kwiecie§   ','Maj        ','Czerwiec   ',
     'Lipiec     ', 'Sierpie§   ', 'Wrzesie§   ',
     'Pa¶dziernik', 'Listopad   ', 'Grudzie§   ');


var
  TestCount : LongInt;
  EmplLib : PEmplCollection;

  LibraryStream : TDosStream;

  IsEmpl : Boolean;
  NoMem : Boolean;


    function CreateEmplWindow(TitleString : String) : PEmplWindow;
    procedure LoadEmplLib;
    procedure SaveEmplLib;
    procedure PrintEmplLib(Header : String);
    procedure NewYear;

    function CalcCurrentDate : String;


implementation

function TEmplCollection.Compare(Key1, Key2 : Pointer) : Integer;
var

 Point1, Point2 : PEmplItem;
 Check : Integer;
begin
 Point1 := Key1;
 Point2 := Key2;
 if Point1^.Name^ + Point1^.FirstName^ < Point2^.Name^ + Point2^.FirstName^ then Check := -1;
 if Point1^.Name^ + Point1^.FirstName^ = Point2^.Name^ + Point2^.FirstName^ then Check := 0;
 if Point1^.Name^ + Point1^.FirstName^ > Point2^.Name^ + Point2^.FirstName^ then Check := 1;

 Compare := Check;
end;

constructor TEmplItem.Init( NewName, NewFirstName, NewFirstName1, NewFathersName, NewMothersName, NewBirthPlace,
     NewBirthDate, NewPesselNumber,
     NewGmina, NewMiejsce, NewNumerDomu, NewNumerMieszk, NewUlica, NewKod, NewWoj, NewStan, NewZatrDate:String;
     NewStaz : StazArray );

     var
      I : Integer;
      X, Y : Integer;
  begin

    Name := NewStr( String40 );
    Name^ := NewName;
    FirstName := NewStr(String40 );
    FirstName^ := NewFirstName;
    FirstName1 := NewStr( String40);
    FirstName1^ :=NewFirstName1 ;
    FathersName := NewStr( String40);
    FathersName^ := NewFathersName ;
    MothersName := NewStr (String40);
    MothersName^ := NewMothersName ;
    BirthPlace := NewStr( String40);
    BirthPlace^ := NewBirthPlace ;
    BirthDate := NewStr( String40);
    BirthDate^ := NewBirthDate ;
    PesselNumber := NewStr( String40);
    PesselNumber^ :=NewPesselNumber ;
    Gmina := NewStr( String40);
    Gmina^ := NewGmina ;
    Miejsce := NewStr( String40);
    Miejsce^ := NewMiejsce ;
    NumerDomu := NewStr( String40);
    NumerDomu^ := NewNumerDomu ;
    NumerMieszk:= NewStr( String40);
    NumerMieszk^:= NewNumerMieszk ;
    Ulica := NewStr( String40);
    Ulica^ := NewUlica ;
    Kod := NewStr( String40);
    Kod^ := NewKod ;
    Woj := NewStr( String40);
    Woj^ := NewWoj ;
    Stan := NewStr( String40);
    Stan^ :=NewStan ;
    ZatrDate := NewStr( String40);
    ZatrDate^ := NewZatrDate ;

    For I := 1 to 10 do
    begin
      Staz[I] := NewStr(String80 );
      Staz[I]^ := NewStaz[I];
    end;
    for X:= 1 to 6 do
       for Y := 1 to 12 do
       begin
        Wynagr[X][Y] := NewStr( String10 );
       end;


  end;

  procedure TEmplItem.Change( NewName, NewFirstName, NewFirstName1, NewFathersName, NewMothersName, NewBirthPlace,
     NewBirthDate, NewPesselNumber,
     NewGmina, NewMiejsce, NewNumerDomu, NewNumerMieszk, NewUlica, NewKod, NewWoj:String);

  begin
    DisposeStr( Name );
    DisposeStr( FirstName);
    DisposeStr( FirstName1 );
    DisposeStr( FathersName );
    DisposeStr( MothersName );
    DisposeStr( BirthPlace );
    DisposeStr( BirthDate );
    DisposeStr( PesselNumber );
    DisposeStr( Gmina );
    DisposeStr( Miejsce );
    DisposeStr( NumerDomu );
    DisposeStr( NumerMieszk);
    DisposeStr( Ulica );
    DisposeStr( Kod );
    DisposeStr( Woj );


    Name := NewStr( String40 );
    Name^ := NewName;
    FirstName := NewStr(String40 );
    FirstName^ := NewFirstName;
    FirstName1 := NewStr( String40);
    FirstName1^ :=NewFirstName1 ;
    FathersName := NewStr( String40);
    FathersName^ := NewFathersName ;
    MothersName := NewStr (String40);
    MothersName^ := NewMothersName ;
    BirthPlace := NewStr( String40);
    BirthPlace^ := NewBirthPlace ;
    BirthDate := NewStr( String40);
    BirthDate^ := NewBirthDate ;
    PesselNumber := NewStr( String40);
    PesselNumber^ :=NewPesselNumber ;
    Gmina := NewStr( String40);
    Gmina^ := NewGmina ;
    Miejsce := NewStr( String40);
    Miejsce^ := NewMiejsce ;
    NumerDomu := NewStr( String40);
    NumerDomu^ := NewNumerDomu ;
    NumerMieszk:= NewStr( String40);
    NumerMieszk^:= NewNumerMieszk ;
    Ulica := NewStr( String40);
    Ulica^ := NewUlica ;
    Kod := NewStr( String40);
    Kod^ := NewKod ;
    Woj := NewStr( String40);
    Woj^ := NewWoj ;


  end;

  destructor TEmplItem.Done;
  var
    I : Integer;
    X, Y : Integer;
  begin

    DisposeStr( Name );
    DisposeStr( FirstName);
    DisposeStr( FirstName1 );
    DisposeStr( FathersName );
    DisposeStr( MothersName );
    DisposeStr( BirthPlace );
    DisposeStr( BirthDate );
    DisposeStr( PesselNumber );
    DisposeStr( Gmina );
    DisposeStr( Miejsce );
    DisposeStr( NumerDomu );
    DisposeStr( NumerMieszk);
    DisposeStr( Ulica );
    DisposeStr( Kod );
    DisposeStr( Woj );
    DisposeStr( Stan );
    DisposeStr( ZatrDate );

    For I := 1 to 10 do DisposeStr(Staz[I]);
        for X:= 1 to 6 do
       for Y := 1 to 12 do DisposeStr(Wynagr[X][Y]);


  end;

  procedure TEmplItem.Store( var S : TStream );
  var I, X, Y : Integer;

  begin
    if Name = nil then Name := NewStr( String40 );
    if FirstName= nil then FirstName := NewStr( String40 );
    if FirstName1= nil then FirstName1 := NewStr( String40 );
    if FathersName= nil then FathersName := NewStr( String40 );
    if MothersName= nil then MothersName := NewStr( String40 );
    if BirthPlace= nil then BirthPlace := NewStr( String40 );
    if BirthDate= nil then BirthDate := NewStr( String40 );
    if PesselNumber= nil then PesselNumber := NewStr( String40 );
    if Gmina= nil then Gmina := NewStr( String40 );
    if Miejsce= nil then Miejsce := NewStr( String40 );
    if NumerDomu= nil then NumerDomu := NewStr( String40 );
    if NumerMieszk= nil then NumerMieszk := NewStr( String40 );
    if Ulica= nil then Ulica := NewStr( String40 );
    if Kod= nil then Kod := NewStr( String40 );
    if Woj= nil then Woj := NewStr( String40 );
    if Stan= nil then Stan := NewStr( String40 );
    if ZatrDate= nil then ZatrDate := NewStr( String40 );

    S.Write( Name^, 40 );
    S.Write( FirstName^, 40 );
    S.Write( FirstName1^, 40 );
    S.Write( FathersName^, 40 );
    S.Write( MothersName^, 40 );
    S.Write( BirthPlace^, 40 );
    S.Write( BirthDate^, 40 );
    S.Write( PesselNumber^, 40 );
    S.Write( Gmina^, 40 );
    S.Write( Miejsce^, 40 );
    S.Write( NumerDomu^, 40 );
    S.Write( NumerMieszk^, 40 );
    S.Write( Ulica^, 40 );
    S.Write( Kod^, 40 );
    S.Write( Woj^, 40 );
    S.Write( Stan^, 40);
    S.Write( ZatrDate^, 40);

    For I := 1 to 10 do
    begin
      if Staz[I] = nil then Staz[I] := NewStr( String80 );
      S.Write(Staz[I]^, 80);
    end;

       for X:= 1 to 6 do
       for Y := 1 to 12 do
       begin
        if Wynagr[X][Y] = nil then Wynagr[X][Y] := NewStr( String10 );
        S.Write(Wynagr[X][Y]^, 10);
       end;

  end;

  constructor TEmplItem.Load( var S : TStream );
  var
  NewName, NewFirstName, NewFirstName1, NewFathersName, NewMothersName, NewBirthPlace,
     NewBirthDate, NewPesselNumber,
     NewGmina, NewDzielnica, NewMiejsce, NewNumerDomu, NewNumerMieszk, NewUlica, NewKod, NewWoj, NewStan, NewZatrDate:String;
     NewStaz : array[1..10] of String[80];
     SampleWynagr : array[1..6,1..12] of String[10];
     I, X, Y : Integer;

  begin

   if NoMem then Exit;

    S.Read( NewName, 40);
    S.Read( NewFirstName, 40);
    S.Read( NewFirstName1, 40);
    S.Read( NewFathersName, 40);
    S.Read( NewMothersName, 40);
    S.Read( NewBirthPlace, 40);
    S.Read( NewBirthDate, 40);
    S.Read( NewPesselNumber, 40);
    S.Read( NewGmina, 40);
    S.Read( NewMiejsce, 40);
    S.Read( NewNumerDomu, 40);
    S.Read( NewNumerMieszk, 40);
    S.Read( NewUlica, 40);
    S.Read( NewKod, 40);
    S.Read( NewWoj, 40);
    S.Read( NewStan, 40);
    S.Read( NewZatrDate, 40);

    For I := 1 to 10 do S.Read(NewStaz[I], 80);

    for X:= 1 to 6 do
       for Y := 1 to 12 do S.Read(SampleWynagr[X][Y], 10);


    if MaxAvail < (27*40+12*6*10) then
    begin
      MessageBox(^C+'Zbyt malo pamieci!!!',
                     nil, mfConfirmation + mfOkButton);
      NoMem := True;
      Exit;
    end;

    Name := NewStr( String40 );
    Name^ := NewName;
    FirstName := NewStr(String40 );
    FirstName^ := NewFirstName;
    FirstName1 := NewStr( String40);
    FirstName1^ :=NewFirstName1 ;
    FathersName := NewStr( String40);
    FathersName^ := NewFathersName ;
    MothersName := NewStr (String40);
    MothersName^ := NewMothersName ;
    BirthPlace := NewStr( String40);
    BirthPlace^ := NewBirthPlace ;
    BirthDate := NewStr( String40);
    BirthDate^ := NewBirthDate ;
    PesselNumber := NewStr( String40);
    PesselNumber^ :=NewPesselNumber ;
    Gmina := NewStr( String40);
    Gmina^ := NewGmina ;
    Miejsce := NewStr( String40);
    Miejsce^ := NewMiejsce ;
    NumerDomu := NewStr( String40);
    NumerDomu^ := NewNumerDomu ;
    NumerMieszk:= NewStr( String40);
    NumerMieszk^:= NewNumerMieszk ;
    Ulica := NewStr( String40);
    Ulica^ := NewUlica ;
    Kod := NewStr( String40);
    Kod^ := NewKod ;
    Woj := NewStr( String40);
    Woj^ := NewWoj ;
    Stan := NewStr( String40);
    Stan^ :=NewStan ;
    ZatrDate := NewStr( String40);
    ZatrDate^ := NewZatrDate ;

    For I := 1 to 10 do
    begin
      Staz[I] := NewStr(String80 );
      Staz[I]^ := NewStaz[I];
    end;
    for X:= 1 to 6 do
       for Y := 1 to 12 do
       begin
        Wynagr[X][Y] := NewStr( String10 );
        Wynagr[X][Y]^ := SampleWynagr[X][Y];
       end;


  end;

  { Empl List Box }

  function TEmplListBox.GetText( Item : Integer; MaxLen : Integer ) : String;
  var
   AuxPointer : PEmplItem;

  begin

   AuxPointer := List^.At(Item);
   GetText := AuxPointer^.Name^ + '  ' + AuxPointer^.FirstName^;

  end;

function CalcCurrentDate : String;
   var
     Year, Month, Day, DayOfWeek : Word;
     SYear, SMonth, SDay, SDayOfWeek : String;
     CalculatedDate: String;

   begin


      GetDate(Year,Month,Day,DayOfWeek);

      Str(Year, SYear);
      Str(Month, SMonth);
      Str(Day, SDay);
      SDayOfWeek := Days[DayOfWeek];
      SYear := Copy(SYear, 3, 2);

      if Day < 10 then SDay := '0' + SDay;
      if Month < 10 then SMonth := '0' + SMonth;


      CalculatedDate:= SDay + '-' + SMonth + '-' + SYear;

      CalcCurrentDate := CalculatedDate;

   end;


  { Empl Window }

  procedure PrintWynagr(FocusedNumber : Integer);
   var
     Year, Month, Day, DayOfWeek : Word;
     SYear, SMonth, SDay, SDayOfWeek : String;
     DateToBePrinted : String;
     ValueControl : Integer;
     ValWynagr    : LongInt;
     ValWynagrReal: Real;
     PRNError : Boolean;
     L, X, Y : Integer;
     W1 : Real;
     Sum1,Sum2,Sum3,Sum4,Sum5,Sum6 : LongInt;
     StrSum1,StrSum2,StrSum3,StrSum4,StrSum5,StrSum6 : String;

   procedure PrintString ( S : string );
    begin
      if PRNError then Exit;
      Write(Lst, S);
      if IOResult<>0 then
       begin
        if MessageBox(^C+'Brak papieru. Kontynuowaç druk ?',
                     nil, mfWarning + mfOkButton + mfCancelButton) = cmOK then
                     begin
                      Write(Lst, S);
                      PRNError := false;
                      Exit;
                     end;
       PRNError:=true;
      end;
    end;

   procedure InitializePrinter;

     begin

       PRNError := false;

       if MessageBox(^C+'Wloz papier do drukarki i wcisnij ON-LINE',
                     nil, mfConfirmation + mfOkButton + mfCancelButton) = cmCancel then PRNError := True;

     end;



   begin

    PRNError := true;
    InitializePrinter;
    if Not PRNError then

     begin


      Sum1 := 0;
      Sum2 := 0;
      Sum3 := 0;
      Sum4 := 0;
      Sum5 := 0;
      Sum6 := 0;
        GetDate(Year,Month,Day,DayOfWeek);

        Str(Year, SYear);
        Str(Month, SMonth);
        Str(Day, SDay);
        SDayOfWeek := Days[DayOfWeek];

        DateToBePrinted := SDayOfWeek + ' ' + SDay + '.' + SMonth + '.' + SYear + #10#13;


      PrintString(#27#72#27#87#00);
      PrintString(#10#13#10#13);

      PrintString(#10#13);
      PrintString(DateToBePrinted);
      PrintString(#10#13);

      For L := 1 to FirmData.TextLen do
         Write(Lst, FirmData.TextData[L]);


            PrintString('  KARTA WYNAGRODZE• PRACOWNIKA'+#10#13);
      PrintString(' Nazwisko i imië : ' + PEmplItem(EmplLib^.At(FocusedNumber))^.Name^ +' '+
                    PEmplItem(EmplLib^.At(FocusedNumber))^.FirstName^);
      PrintString(#10#13#10#13);
      PrintString('------------------------------------------------------------------------------');
      PrintString(#10#13);
      PrintString('                                                      Zasiíki z ubezp. spoí.'+#10#13);
      PrintString('          Wynagrodz.  Koszty   Doch¢d do   Pobrana  Wypíacone p.  Pobrana'+#10#13);
      PrintString(' MiesiÜc    brutto   uzyskania opodatkow.  zaliczka zakíad pracy  zaliczka');
      PrintString(#10#13);
      PrintString('------------------------------------------------------------------------------');
      PrintString(#10#13);

      for Y:= 1 to 12 do
      begin
        PrintString(Months[Y]+' ');
        for X:=1 to 6 do
         begin

         Val(PEmplItem(EmplLib^.At(FocusedNumber))^.Wynagr[X][Y]^, ValWynagrReal, ValueControl);
         if ValWynagrReal > 17800 then
         begin
           DisposeStr(PEmplItem(EmplLib^.At(FocusedNumber))^.Wynagr[X][Y]);

           PEmplItem(EmplLib^.At(FocusedNumber))^.Wynagr[X][Y] := NewStr( String40 );
           PEmplItem(EmplLib^.At(FocusedNumber))^.Wynagr[X][Y]^ := '0';
         end;


         if ValueControl = 0 then
            PrintString(PEmplItem(EmplLib^.At(FocusedNumber))^.Wynagr[X][Y]^ +
              Copy(Spaces80, 1, 12-Length(PEmplItem(EmplLib^.At(FocusedNumber))^.Wynagr[X][Y]^+' ')))
         else
            PrintString('0          ');
          end;

        PrintString(#10#13);
        PrintString('------------------------------------------------------------------------------'+#10#13);

        Val(PEmplItem(EmplLib^.At(FocusedNumber))^.Wynagr[1][Y]^,W1, ValueControl);
        if ValueControl = 0 then Sum1 := Sum1 + Round(W1*10000);
        Val(PEmplItem(EmplLib^.At(FocusedNumber))^.Wynagr[2][Y]^,W1, ValueControl);
        if ValueControl = 0 then Sum2 := Sum2 + Round(W1*10000);
        Val(PEmplItem(EmplLib^.At(FocusedNumber))^.Wynagr[3][Y]^,W1, ValueControl);
        if ValueControl = 0 then Sum3 := Sum3 + Round(W1*10000);
        Val(PEmplItem(EmplLib^.At(FocusedNumber))^.Wynagr[4][Y]^,W1, ValueControl);
        if ValueControl = 0 then Sum4 := Sum4 + Round(W1*10000);
        Val(PEmplItem(EmplLib^.At(FocusedNumber))^.Wynagr[5][Y]^,W1, ValueControl);
        if ValueControl = 0 then Sum5 := Sum5 + Round(W1*10000);
        Val(PEmplItem(EmplLib^.At(FocusedNumber))^.Wynagr[6][Y]^,W1, ValueControl);
        if ValueControl = 0 then Sum6 := Sum6 + Round(W1*10000);


      end;

      Str(Sum1, StrSum1);
      Str(Sum2, StrSum2);
      Str(Sum3, StrSum3);
      Str(Sum4, StrSum4);
      Str(Sum5, StrSum5);
      Str(Sum6, StrSum6);

      StrSum1 := ChangeToGr( StrSum1 );
      StrSum2 := ChangeToGr( StrSum2 );
      StrSum3 := ChangeToGr( StrSum3 );
      StrSum4 := ChangeToGr( StrSum4 );
      StrSum5 := ChangeToGr( StrSum5 );
      StrSum6 := ChangeToGr( StrSum6 );

      PrintString(' RAZEM :    '+StrSum1 +Copy(Spaces80, 1, 10-Length(StrSum1))+' ');
      PrintString(StrSum2 +Copy(Spaces80, 1, 10-Length(StrSum2))+' ');
      PrintString(StrSum3 +Copy(Spaces80, 1, 10-Length(StrSum3))+' ');
      PrintString(StrSum4 +Copy(Spaces80, 1, 10-Length(StrSum4))+' ');
      PrintString(StrSum5 +Copy(Spaces80, 1, 10-Length(StrSum5))+' ');
      PrintString(StrSum6 +Copy(Spaces80, 1, 10-Length(StrSum6))+' ');
      PrintString(#10#13);
      PrintString('------------------------------------------------------------------------------');
      PrintString(#10#13#10#13#10#13);



    end;

   end;

  procedure PrintSingleEmpl(FocusedNumber : Integer);
   var
     Year, Month, Day, DayOfWeek : Word;
     SYear, SMonth, SDay, SDayOfWeek : String;
     DateToBePrinted : String;
     ValueControl : Integer;
     ValWynagr    : LongInt;
     PRNError : Boolean;
     L, X, Y : Integer;
     W1 : LongInt;
     Sum1,Sum2,Sum3,Sum4,Sum5,Sum6 : LongInt;
     StrSum1,StrSum2,StrSum3,StrSum4,StrSum5,StrSum6 : String;

   procedure PrintString ( S : string );
    begin
      if PRNError then Exit;
      Write(Lst, S);
      if IOResult<>0 then
       begin
        if MessageBox(^C+'Brak paieru. Kontynuowaç druk ?',
                     nil, mfWarning + mfOkButton + mfCancelButton) = cmOK then
                     begin
                      Write(Lst, S);
                      PRNError := false;
                      Exit;
                     end;
       PRNError:=true;
      end;
    end;

   procedure InitializePrinter;

     begin

       PRNError := false;

       if MessageBox(^C+'Wloz papier do drukarki i wcisnij ON-LINE',
                     nil, mfConfirmation + mfOkButton + mfCancelButton) = cmCancel then PRNError := True;

     end;



   begin

    PRNError := true;
    InitializePrinter;
    if Not PRNError then

     begin


        GetDate(Year,Month,Day,DayOfWeek);

        Str(Year, SYear);
        Str(Month, SMonth);
        Str(Day, SDay);
        SDayOfWeek := Days[DayOfWeek];

        DateToBePrinted := SDayOfWeek + ' ' + SDay + '.' + SMonth + '.' + SYear + #10#13;


      PrintString(#10#13);
      PrintString(DateToBePrinted);
      PrintString(#10#13);

      For L := 1 to FirmData.TextLen do
         Write(Lst, FirmData.TextData[L]);


      PrintString(#10#13#10#13);
      PrintString('  DANE PERSONALNE PRACOWNIKA'+#10#13);
      PrintString(' Nazwisko i imië : ' + PEmplItem(EmplLib^.At(FocusedNumber))^.Name^ +' '+
                    PEmplItem(EmplLib^.At(FocusedNumber))^.FirstName^);
      PrintString(#10#13#10#13);
      PrintString('------------------------------------------------------------------------------');
      PrintString(#10#13);

      PrintString('Nazwisko : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.Name^ + #10#13);
      PrintString('Imië1    : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.FirstName^+ #10#13);
      PrintString('Imië2    : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.FirstName1^+ #10#13);
      PrintString('Imië ojca  : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.FathersName^+ #10#13);
      PrintString('Imië matki : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.MothersName^+ #10#13);
      PrintString('Miejsce urodzenia : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.BirthPlace^+ #10#13);
      PrintString('Data urodzenia : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.BirthDate^+ #10#13);
      PrintString('Nr. ewidencyjny : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.PesselNumber^+ #10#13);
      PrintString('Gmina\dzielnica : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.Gmina^+ #10#13);
      PrintString('Miejscowoûç : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.Miejsce^+ #10#13);
      PrintString('Numer domu : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.NumerDomu^+ #10#13);
      PrintString('Numer mieszk. : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.NumerMieszk^+ #10#13);
      PrintString('Ulica : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.Ulica^+ #10#13);
      PrintString('Kod pocztowy : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.Kod^+ #10#13);
      PrintString('Wojew¢dztwo  : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.Woj^+ #10#13);
      PrintString('Stanowisko : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.Stan^+ #10#13);
      PrintString('Data zatr. : '+ PEmplItem(EmplLib^.At(FocusedNumber))^.ZatrDate^+ #10#13);
      PrintString('Staß :' +#10#13);
      PrintString(' Nazwa zakíadu\data zatrudnienia\data zwolnienia' +#10#13);


      for X:=1 to 10 do PrintString(PEmplItem(EmplLib^.At(FocusedNumber))^.Staz[X]^ +#10#13);

        PrintString(#10#13);
        PrintString('------------------------------------------------------------------------------'+#10#13#10#13#10#13);


    end;

   end;


  procedure TEmplWindow.HandleEvent ( var Event : TEvent );

  var
   SecondControl : Word;
   FirstPointer, SecondPointer  : PEmplItem;
   SampleValue : LongInt;
   ValueControl : Integer;
   AuxValue : Real;
   SampleArray : array [1..10] of String[80];
   SampleWynagr : array[1..6,1..12] of String[10];
   X, Y : Integer;
   SampleEmplItem : PEmplItem;
   Month, Year, Day, DayOfWeek : Word;
   StrMonth : String;

   procedure CalcCurrentMonth;
     begin
       GetDate(Year, Month, Day, DayOfWeek);
     end;

  begin
    TDialog.HandleEvent ( Event );

     if Event.What = evCommand then
       case Event.Command of
         cmPrintWynagr : PrintWynagr(ListBoxPointer^.Focused);
         cmPrintSingleEmpl : PrintSingleEmpl(ListBoxPointer^.Focused);
         cmEmplWynagr: begin

                        if ListBoxPointer^.Range = 0 then
                         begin
                           MessageBox(^C+'Brak jakiegokolwiek wpisu',
                                       nil, mfInformation + mfOkButton);
                           ClearEvent( Event );
                           Exit;
                         end;

                        with ThirdDialogData do
                        begin

                         CalcCurrentMonth;
                         Str(Month, StrMonth);

                         repeat
                          QueryBox(StrMonth, 'Kt¢ry miesiÜc ?');
                          Val(StrMonth, Month, ValueControl);
                          if (ValueControl <> 0) or (Month>12) or (Month<1) then

                           begin
                             MessageBox(^C+'Bíëdny numer miesiÜca',
                                        nil, mfInformation + mfOkButton);
                             ValueControl := 1;
                           end;

                         until ValueControl = 0;

                         FirstPointer := ListBoxPointer^.List^.At( ListBoxPointer^.Focused ) ;
                         InpLine1 := (FirstPointer^.Wynagr[1][Month])^;
                         InpLine2 := (FirstPointer^.Wynagr[2][Month])^;
                         InpLine3 := (FirstPointer^.Wynagr[3][Month])^;
                         InpLine4 := (FirstPointer^.Wynagr[4][Month])^;
                         InpLine5 := (FirstPointer^.Wynagr[5][Month])^;
                         InpLine6 := (FirstPointer^.Wynagr[6][Month])^;
                         InpLine7 := StrMonth;

                            Val(InpLine1, AuxValue, ValueControl);
                            if (AuxValue < 0) or (AuxValue > 17800) or (ValueControl <> 0) then InpLine1 := '0';
                            Val(InpLine2, AuxValue, ValueControl);
                            if (AuxValue < 0) or (AuxValue > 17800) or (ValueControl <> 0)then InpLine2 := '0';
                            Val(InpLine3, AuxValue, ValueControl);
                            if (AuxValue < 0) or (AuxValue > 17800) or (ValueControl <> 0)then InpLine3 := '0';
                            Val(InpLine4, AuxValue, ValueControl);
                            if (AuxValue < 0) or (AuxValue > 17800) or  (ValueControl <> 0)then InpLine4 := '0';
                            Val(InpLine5, AuxValue, ValueControl);
                            if (AuxValue < 0) or (AuxValue > 17800) or  (ValueControl <> 0)then InpLine5 := '0';
                            Val(InpLine6, AuxValue, ValueControl);
                            if (AuxValue < 0) or (AuxValue > 17800) or  (ValueControl <> 0)then InpLine6 := '0';





                        end;

                        ThirdDialog^.SetData(ThirdDialogData);

                        SecondControl := Desktop^.ExecView( ThirdDialog );
                        if SecondControl <> cmCancel then
                        begin
                          ThirdDialog^.GetData(ThirdDialogData);

                        { Here the data control }

                        with ThirdDialogData do
                        begin
{                        System.Delete ( FirstInputLine , 31 , 255 );
                          System.Delete ( SecondInputLine , 8 , 255 );
                          System.Delete ( ThirdInputLine, 5, 255 );    }


                          Val(InpLine7, Month, ValueControl);

                          if ValueControl = 0 then
                          begin
                            Val(InpLine1, AuxValue, ValueControl);
                            if (AuxValue < 0) or (AuxValue > 17800) then ValueControl := 1;
                          end;
                          if ValueControl = 0 then
                          begin
                            Val(InpLine2, AuxValue, ValueControl);
                            if (AuxValue < 0) or (AuxValue > 17800) then ValueControl := 1;
                          end;
                          if ValueControl = 0 then
                          begin
                            Val(InpLine3, AuxValue, ValueControl);
                            if (AuxValue < 0) or (AuxValue > 17800) then ValueControl := 1;
                          end;
                          if ValueControl = 0 then
                          begin
                            Val(InpLine4, AuxValue, ValueControl);
                            if (AuxValue < 0) or (AuxValue > 17800) then ValueControl := 1;
                          end;
                          if ValueControl = 0 then
                          begin
                            Val(InpLine5, AuxValue, ValueControl);
                            if (AuxValue < 0) or (AuxValue > 17800) then ValueControl := 1;
                          end;
                          if ValueControl = 0 then
                          begin
                            Val(InpLine6, AuxValue, ValueControl);
                            if (AuxValue < 0) or (AuxValue > 17800) then ValueControl := 1;
                          end;

                          if (ValueControl = 0) and (Month <13) and (Month>0) then
                          begin

                          For X := 1 to 6 do
                             DisposeStr(PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[X][Month]);

                           PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[1][Month] := NewStr(String10);
                           PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[1][Month]^ := InpLine1;
                           PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[2][Month] := NewStr(String10);
                           PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[2][Month]^ := InpLine2;
                           PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[3][Month] := NewStr(String10);
                           PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[3][Month]^ := InpLine3;
                           PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[4][Month] := NewStr(String10);
                           PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[4][Month]^ := InpLine4;
                           PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[5][Month] := NewStr(String10);
                           PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[5][Month]^ := InpLine5;
                           PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[6][Month] := NewStr(String10);
                           PEmplItem(ListBoxPointer^.List^.At(ListBoxPointer^.Focused))^.Wynagr[6][Month]^ := InpLine6;
                          end
                          else
                          MessageBox(^C+'Bíëdny numer miesiÜca lub wartoûç pola',
                                       nil, mfInformation + mfOkButton);

                        end;

                       end;

                        ListBoxPointer^.DrawView;

                       end;

         cmEmplDelete : begin

                         if ListBoxPointer^.Range = 0 then
                         begin
                           MessageBox(^C+'Brak jakiegokolwiek wpisu',
                                       nil, mfInformation + mfOkButton);
                           ClearEvent( Event );
                           Exit;
                         end;

                         ListBoxPointer^.List^.AtFree( ListBoxPointer^.Focused );
                         ListBoxPointer^.SetRange( ListBoxPointer^.List^.Count );
                         ListBoxPointer^.DrawView;

                       end;

         cmEmplModify : begin

                        if ListBoxPointer^.Range = 0 then
                         begin
                           MessageBox(^C+'Brak jakiegokolwiek wpisu',
                                       nil, mfInformation + mfOkButton);
                           ClearEvent( Event );
                           Exit;
                         end;

                        with SecondDialogData do
                        begin
                         FirstPointer := ListBoxPointer^.List^.At( ListBoxPointer^.Focused ) ;
                         InputLine1 := FirstPointer^.Name^;
                         InputLine2 := FirstPointer^.FirstName^;
                         InputLine3 := FirstPointer^.FirstName1^;
                         InputLine4 := FirstPointer^.FathersName^;
                         InputLine5 := FirstPointer^.MothersName^;
                         InputLine6 := FirstPointer^.BirthPlace^;
                         InputLine7 := FirstPointer^.BirthDate^;
                         InputLine8 := FirstPointer^.PesselNumber^;
                         InputLine9 := FirstPointer^.Gmina^;
                         InputLine10:= FirstPointer^.Miejsce^;
                         InputLine11:= FirstPointer^.NumerDomu^;
                         InputLine12:= FirstPointer^.NumerMieszk^;
                         InputLine13:= FirstPointer^.Ulica^;
                         InputLine14:= FirstPointer^.Kod^;
                         InputLine15:= FirstPointer^.Woj^;
                         InputLine16:=FirstPointer^.Stan^;
                         InputLine17:=FirstPointer^.ZatrDate^;
                         InputStaz1:=FirstPointer^.Staz[1]^;
                         InputStaz2:=FirstPointer^.Staz[2]^;
                         InputStaz3:=FirstPointer^.Staz[3]^;
                         InputStaz4:=FirstPointer^.Staz[4]^;
                         InputStaz5:=FirstPointer^.Staz[5]^;
                         InputStaz6:=FirstPointer^.Staz[6]^;
                         InputStaz7:=FirstPointer^.Staz[7]^;
                         InputStaz8:=FirstPointer^.Staz[8]^;
                         InputStaz9:=FirstPointer^.Staz[9]^;
                         InputStaz10:=FirstPointer^.Staz[10]^;


                        end;

                        SecondDialog^.SetData(SecondDialogData);
                        SecondDialog^.FirstItemPointer^.Select;

                        SecondControl := Desktop^.ExecView( SecondDialog );
                        if SecondControl <> cmCancel then
                        begin
                          SecondDialog^.GetData(SecondDialogData);

                        { Here the data control }

                        with SecondDialogData do
                        begin
{                        System.Delete ( FirstInputLine , 31 , 255 );
                          System.Delete ( SecondInputLine , 8 , 255 );
                          System.Delete ( ThirdInputLine, 5, 255 );    }




                          SampleArray[1] := InputStaz1;
                          if SampleArray[1] = '' then SampleArray[1] := ' ';
                          SampleArray[2] := InputStaz2;
                          if SampleArray[2] = '' then SampleArray[2] := ' ';
                          SampleArray[3] := InputStaz3;
                          if SampleArray[3] = '' then SampleArray[3] := ' ';
                          SampleArray[4] := InputStaz4;
                          if SampleArray[4] = '' then SampleArray[4] := ' ';
                          SampleArray[5] := InputStaz5;
                          if SampleArray[5] = '' then SampleArray[5] := ' ';
                          SampleArray[6] := InputStaz6;
                          if SampleArray[6] = '' then SampleArray[6] := ' ';
                          SampleArray[7] := InputStaz7;
                          if SampleArray[7] = '' then SampleArray[7] := ' ';
                          SampleArray[8] := InputStaz8;
                          if SampleArray[8] = '' then SampleArray[8] := ' ';
                          SampleArray[9] := InputStaz9;
                          if SampleArray[9] = '' then SampleArray[9] := ' ';
                          SampleArray[10] := InputStaz10;
                          if SampleArray[10] = '' then SampleArray[10] := ' ';

                          for X:= 1 to 6 do
                           for Y := 1 to 12 do
                           begin

                          SampleWynagr[X][Y] := PEmplItem(ListBoxPointer^.List^.At( ListBoxPointer^.Focused ))^.Wynagr[X][Y]^;
                           end;


                              ListBoxPointer^.List^.AtFree( ListBoxPointer^.Focused );

                              SampleEmplItem := New( PEmplItem, Init(InputLine1, InputLine2,
                              InputLine3,InputLine4,InputLine5,InputLine6, InputLine7,
                              InputLine8, InputLine9,
                              InputLine10,InputLine11,InputLine12,InputLine13, InputLine14, InputLine15,
                              InputLine16, InputLine17,
                              StazArray(SampleArray)));

                              for X:= 1 to 6 do
                           for Y := 1 to 12 do DisposeStr(SampleEmplItem^.Wynagr[X][Y]);

                              for X:= 1 to 6 do
                           for Y := 1 to 12 do
                           begin


                             SampleEmplItem^.Wynagr[X][Y] := NewStr(String10);
                             SampleEmplItem^.Wynagr[X][Y]^ := SampleWynagr[X][Y];

                           end;
                           ListBoxPointer^.List^.Insert(SampleEmplItem);


                        end;
                       end;

                        ListBoxPointer^.DrawView;

                       end;

         cmEmplAdd : begin

                        with SecondDialogData do
                        begin
                         InputLine1 := ' ';
                         InputLine2 := ' ';
                         InputLine3 := ' ';
                         InputLine4 := ' ';
                         InputLine5 := ' ';
                         InputLine6 := ' ';
                         InputLine7 := ' ';
                         InputLine8 := ' ';
                         InputLine9 := ' ';
                         InputLine10:= ' ';
                         InputLine11:= ' ';
                         InputLine12:= ' ';
                         InputLine13:= ' ';
                         InputLine14:= ' ';
                         InputLine15:= ' ';
                         InputLine16:= ' ';
                         InputLine17:= ' ';
                         InputStaz1:=' ';
                         InputStaz2:=' ';
                         InputStaz3:=' ';
                         InputStaz4:=' ';
                         InputStaz5:=' ';
                         InputStaz6:=' ';
                         InputStaz7:=' ';
                         InputStaz8:=' ';
                         InputStaz9:=' ';
                         InputStaz10:=' ';



                        end;

                        SecondDialog^.SetData(SecondDialogData);
                        SecondDialog^.FirstItemPointer^.Select;

                        SecondControl := DeskTop^.ExecView( SecondDialog );
                        if SecondControl <> cmCancel then
                        begin
                          SecondDialog^.GetData(SecondDialogData);

                        { Here the data control }

                        with SecondDialogData do
                        begin
{                         System.Delete ( FirstInputLine , 31 , 255 );
                          System.Delete ( SecondInputLine , 8 , 255 );
                          System.Delete ( ThirdInputLine,    5, 255 );   }

                          SampleArray[1] := InputStaz1;
                          if SampleArray[1] = '' then SampleArray[1] := ' ';
                          SampleArray[2] := InputStaz2;
                          if SampleArray[2] = '' then SampleArray[2] := ' ';
                          SampleArray[3] := InputStaz3;
                          if SampleArray[3] = '' then SampleArray[3] := ' ';
                          SampleArray[4] := InputStaz4;
                          if SampleArray[4] = '' then SampleArray[4] := ' ';
                          SampleArray[5] := InputStaz5;
                          if SampleArray[5] = '' then SampleArray[5] := ' ';
                          SampleArray[6] := InputStaz6;
                          if SampleArray[6] = '' then SampleArray[6] := ' ';
                          SampleArray[7] := InputStaz7;
                          if SampleArray[7] = '' then SampleArray[7] := ' ';
                          SampleArray[8] := InputStaz8;
                          if SampleArray[8] = '' then SampleArray[8] := ' ';
                          SampleArray[9] := InputStaz9;
                          if SampleArray[9] = '' then SampleArray[9] := ' ';
                          SampleArray[10] := InputStaz10;
                          if SampleArray[10] = '' then SampleArray[10] := ' ';


                              ListBoxPointer^.List^.Insert(New( PEmplItem, Init(InputLine1, InputLine2,
                              InputLine3,InputLine4,InputLine5,InputLine6, InputLine7,
                              InputLine8, InputLine9,
                              InputLine10,InputLine11,InputLine12,InputLine13, InputLine14, InputLine15,
                              InputLine16, InputLine17,
                              StazArray(SampleArray)
                              )));


                              ListBoxPointer^.SetRange(ListBoxPointer^.List^.Count);
                        end;
                       end;

                        ListBoxPointer^.DrawView;

                       end;
       end;

   end;

   procedure TEmplWindow.Close;
    begin
     Dispose( SecondDialog, Done);
     TDialog.Close;
     IsEmpl := false;
    end;


  procedure LoadEmplLib;
  begin

    NoMem := False;
    LibraryStream.Init('EMPL.LIB', stOpenRead);

    EmplLib   := PEmplCollection(LibraryStream.Get);


    LibraryStream.Done;
    NoMem := False;

    if LibraryStream.Status <> 0 then
    begin

      EmplLib   := New(PEmplCollection, Init(1, 1));
      MessageBox(^C+'Nie moge odczytac biblioteki pracownik¢w!',nil,
      mfError+mfOKButton);

    end;

  end;

  procedure SaveEmplLib;
  begin

    LibraryStream.Init('EMPL.LIB', stCreate);

    LibraryStream.Put( EmplLib );

    LibraryStream.Done;

    if LibraryStream.Status <> 0 then
      MessageBox(^C+'Nie mogë zapisaç biblioteki pracownik¢w',nil,
                 mfError+mfOKButton);

  end;

  



  procedure NewYear;
    {$F+}
    procedure DelWynagr(P : PEmplItem); Far;
     var
       X, Y : Integer;
     begin

       for X:= 1 to 6 do
          for Y := 1 to 12 do
          begin
           DisposeStr(P^.Wynagr[X][Y]);
           P^.Wynagr[X][Y] := NewStr( String10 );
          end;
      end;
{$F-}

  begin
   if MessageBox(^C+'USUWANIE DANYCH O WYNAGRODZENIU !!!',
               nil, mfWarning + mfOkButton + mfCancelButton) = cmOK then
               begin
                 EmplLib^.ForEach(@DelWynagr);
               end;
  end;

  procedure PrintEmplLib(Header : String);
   var
     Year, Month, Day, DayOfWeek : Word;
     SYear, SMonth, SDay, SDayOfWeek : String;
     DateToBePrinted : String;
     PRNError : Boolean;
     L : Integer;

   procedure PrintString ( S : string );
    begin
      if PRNError then Exit;
      Write(Lst, S);
      if IOResult<>0 then
       begin
        if MessageBox(^C+'Brak paieru. Kontynuowaç druk ?',
                     nil, mfWarning + mfOkButton + mfCancelButton) = cmOK then
                     begin
                      Write(Lst, S);
                      PRNError := false;
                      Exit;
                     end;
       PRNError:=true;
      end;
    end;

   procedure InitializePrinter;

     begin

       PRNError := false;

       if MessageBox(^C+'Wloz papier do drukarki i wcisnij ON-LINE',
                     nil, mfConfirmation + mfOkButton + mfCancelButton) = cmCancel then PRNError := true;

     end;


{$F+}
   procedure PrintEmplLine(P : PEmplItem); Far;
     begin

       PrintString('  '+P^.Name^ + '  ' + P^.FirstName^+#10#13);

      end;
{$F-}




   begin

    PRNError := true;
    InitializePrinter;
    if Not PRNError then

     begin


        GetDate(Year,Month,Day,DayOfWeek);

        Str(Year, SYear);
        Str(Month, SMonth);
        Str(Day, SDay);
        SDayOfWeek := Days[DayOfWeek];

        DateToBePrinted := SDayOfWeek + ' ' + SDay + '.' + SMonth + '.' + SYear + #10#13;


      PrintString(#10#13);
      PrintString(DateToBePrinted);
      PrintString(#10#13);

      For L := 1 to FirmData.TextLen do
         Write(Lst, FirmData.TextData[L]);


      PrintString(#10#13#10#13);
      PrintString(Header);
      PrintString(#10#13#10#13);
      PrintString('------------------------------------------------------------------------------');
      PrintString(#10#13);
      PrintString('  Nazwisko i imië pracownika');
      PrintString(#10#13);
      PrintString('------------------------------------------------------------------------------');
      PrintString(#10#13);

      EmplLib^.ForEach(@PrintEmplLine);

      PrintString('------------------------------------------------------------------------------');
      PrintString(#10#13#10#13#10#13);



    end;

   end;




  function CreateEmplWindow(TitleString : String) : PEmplWindow;
  var
   R : TRect;
   B : PListBox;
   C : PInputLine;
   Dialog : PEmplWindow;
   ScrollBarLine : PScrollBar;
   Control : Word;

  begin

   R.Assign(0, 0, 66, 19);
   Dialog := New( PEmplWindow, Init( R, TitleString));

   with Dialog^ do
   begin
    { Third Dialog  }
    R.Assign(0, 0, 80, 13);

    ThirdDialog := New( PSecondDialog, Init( R, 'Edycja pola'));
    with ThirdDialog^ do
    begin

      R.Assign( 2, 10, 12, 12);
      Insert( New( PButton, Init( R, 'O~K~', cmOK, bfDefault)));
      R.Move( 10, 0);
      Insert( New( PButton, Init( R, '~P~orzuc', cmCancel, bfNormal)));



      R.Assign( 2, 2, 24, 3);
      C :=  New( PInputLine, Init( R, 10 ));
      Insert( C );
      FirstItemPointer := C;
      R.Assign( 2,1,24,2);
      Insert( New( PLabel, Init( R, 'Wynagrodzenie brutto', C)));

      R.Assign( 25, 2, 44, 3);
      C :=  New( PInputLine, Init( R, 10 ));
      Insert( C );
      FirstItemPointer := C;
      R.Assign( 25,1,44,2);
      Insert( New( PLabel, Init( R, 'Koszty uzyskania', C)));

      R.Assign( 45, 2, 68, 3);
      C :=  New( PInputLine, Init( R, 10 ));
      Insert( C );
      R.Assign( 45,1,68,2);
      Insert( New( PLabel, Init( R, 'Doch¢d do opodatkow.', C)));

      R.Assign( 69, 2, 78, 3);
      C :=  New( PInputLine, Init( R, 10 ));
      Insert( C );
      FirstItemPointer := C;
      R.Assign( 69,1,78,2);
      Insert( New( PLabel, Init( R, 'Pobr.zal.', C)));

      R.Assign( 2, 4, 30, 5);
      C :=  New( PInputLine, Init( R, 10 ));
      Insert( C );
      FirstItemPointer := C;
      R.Assign( 2,3,30,4);
      Insert( New( PLabel, Init( R, 'Zasiíki wypí. przez zakíad',C)));

      R.Assign( 32, 4, 62, 5);
      C :=  New( PInputLine, Init( R, 10 ));
      Insert( C );
      FirstItemPointer := C;
      R.Assign( 32,3,62,4);
      Insert( New( PLabel, Init( R, 'Zasiíki - pobr.zalicz.', C)));

      R.Assign( 64, 4, 74, 5);
      C :=  New( PInputLine, Init( R, 10 ));
      Insert( C );
      FirstItemPointer := C;
      R.Assign( 64,3,74,4);
      Insert( New( PLabel, Init( R, 'MiesiÜc', C)));

    end;

    { Second dialog }

    R.Assign(0, 0, 78, 23);

    SecondDialog := New( PSecondDialog, Init( R, 'Edycja pola'));
    with SecondDialog^ do
    begin

      R.Assign( 2, 20, 12, 22);
      Insert( New( PButton, Init( R, 'O~K~', cmOK, bfDefault)));
      R.Move( 10, 0);
      Insert( New( PButton, Init( R, '~P~orzuc', cmCancel, bfNormal)));
    {   R.Grow( 10, 0);
       R.Move( 20, 0);
      Insert( New( PButton, Init( R, '~M~odyfikuj\dodaj staß', cmCancel, bfNormal)));  }



      R.Assign( 2, 2, 40, 3);
      C :=  New( PInputLine, Init( R, 40 ));
      Insert( C );
      FirstItemPointer := C;
      R.Assign( 2,1,40,2);
      Insert( New( PLabel, Init( R, 'Nazwisko', C)));

      R.Assign( 42, 2, 57, 3);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign( 42,1,57,2);
      Insert( New( PLabel, Init( R, 'Imië1', C)));

      R.Assign( 60, 2, 75, 3);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign( 60,1,75,2);
      Insert( New( PLabel, Init( R, 'Imië2', C)));

      R.Assign( 42, 4, 57, 5);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign( 42,3,57,4);
      Insert( New( PLabel, Init( R, 'Imië ojca', C)));

      R.Assign( 60, 4, 75, 5);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign( 60,3,75,4);
      Insert( New( PLabel, Init( R, 'Imië matki', C)));

      R.Assign( 2, 6, 50, 7);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign( 2,5,50,6);
      Insert( New( PLabel, Init( R, 'Miejsce urodzenia', C)));

      R.Assign( 52,6, 75,7);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign( 52,5,75,6);
      Insert( New( PLabel, Init( R, 'Data urodzenia', C)));

      R.Assign( 2,8, 20,9);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign( 2,7,20,8);
      Insert( New( PLabel, Init( R, 'Nr. ewidenc.', C)));

      R.Assign(2,10, 40,11);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign(2,9,40,10);
      Insert( New( PLabel, Init( R, 'Gmina\dzielnica', C)));

      R.Assign(42,10, 75,11);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign(42,9,75,10);
      Insert( New( PLabel, Init( R, 'Miejscowoûç', C)));

      R.Assign(2,12, 11,13);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign(2,11,11,12);
      Insert( New( PLabel, Init( R, 'Nr. domu', C)));

      R.Assign(12,12, 24,13);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign(12,11,24,12);
      Insert( New( PLabel, Init( R, 'Nr. mieszk.', C)));

      R.Assign(26,12, 45,13);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign(26,11,45,12);
      Insert( New( PLabel, Init( R, 'Ulica', C)));

      R.Assign(47,12, 57,13);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign(47,11,57,12);
      Insert( New( PLabel, Init( R, 'Kod', C)));

      R.Assign(60,12, 75,13);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign(60,11,75,12);
      Insert( New( PLabel, Init( R, 'Wojew¢dztwo', C)));

      R.Assign(40,20, 55,21);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign(40,19,55,20);
      Insert( New( PLabel, Init( R, 'Stanowisko', C)));

      R.Assign(58,20, 75,21);
      C := New( PInputLine, Init( R, 40 ));
      Insert( C );
      R.Assign(58,19,75,20);
      Insert( New( PLabel, Init( R, 'Data zatr.', C)));

      R.Assign(2,13,75,14);
      Insert( New( PStaticText, Init( R, 'Staz')));

      R.Assign(2,14, 37,15);
      C := New( PInputLine, Init( R, 80 ));
      Insert( C );
      R.Assign(2,15, 37,16);
      C := New( PInputLine, Init( R, 80 ));
      Insert( C );
      R.Assign(2,16, 37,17);
      C := New( PInputLine, Init( R, 80 ));
      Insert( C );
      R.Assign(2,17, 37,18);
      C := New( PInputLine, Init( R, 80 ));
      Insert( C );
      R.Assign(2,18, 37,19);
      C := New( PInputLine, Init( R, 80 ));
      Insert( C );

      R.Assign(39,14, 75,15);
      C := New( PInputLine, Init( R, 80 ));
      Insert( C );
      R.Assign(39,15, 75,16);
      C := New( PInputLine, Init( R, 80 ));
      Insert( C );
      R.Assign(39,16, 75,17);
      C := New( PInputLine, Init( R, 80 ));
      Insert( C );
      R.Assign(39,17, 75,18);
      C := New( PInputLine, Init( R, 80 ));
      Insert( C );
      R.Assign(39,18, 75,19);
      C := New( PInputLine, Init( R, 80 ));
      Insert( C );

      

      

      Options := Options or ofTopSelect;
      Options := Options or ofCentered;

    end;

    R.Assign( 2, 14, 12, 16);
    Insert( New( PButton, Init( R, '~D~odaj', cmEmplAdd, bfNormal)));
    R.Move(10,0);
    Insert( New( PButton, Init( R, '~U~sun', cmEmplDelete, bfNormal)));
    R.Move(12,0);
    R.Grow(2,0);
    Insert( New( PButton, Init( R, '~M~odyfikuj', cmEmplModify, bfDefault)));

    R.Move(14,0);
    Insert( New( PButton, Init( R, '~W~ynagr.', cmEmplWynagr, bfNormal)));
    R.Move(12,0);
    Insert( New( PButton, Init( R, '~K~arta', cmPrintWynagr, bfNormal)));
    R.Move(0,2);
    Insert( New( PButton, Init( R, 'D~r~uk', cmPrintSingleEmpl, bfNormal)));



    R.Assign(52,2,53,12);
    ScrollBarLine := New( PScrollBar, Init(R));
    Insert( ScrollBarLine );
    R.Assign(2, 2, 52, 12);

    B := New( PEmplListBox, Init( R, 1, ScrollBarLine));

    B^. NewList( EmplLib );
    Insert(B);
    ListBoxPointer := B;

    Options := Options or ofCentered;

   end;

   if Application^.ValidView( Dialog ) <> nil then
   begin
     CreateEmplWindow := Dialog;
     IsEmpl := True;
   end;

  end;



end.  {of unit}